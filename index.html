<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="3WOMyh0YrdEECGDv2GOACbgBEtVz_dJbyA_2G-pjr28">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"liujiaboy.github.io","root":"/","scheme":"Pisces","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="一只iOS程序猿，会陆陆续续的把之前的一些总结搬到这里。">
<meta property="og:type" content="website">
<meta property="og:title" content="不会飞的小白">
<meta property="og:url" content="http://liujiaboy.github.io/index.html">
<meta property="og:site_name" content="不会飞的小白">
<meta property="og:description" content="一只iOS程序猿，会陆陆续续的把之前的一些总结搬到这里。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="不会飞的小白">
<meta property="article:tag" content="iOS">
<meta property="article:tag" content=" Swift">
<meta property="article:tag" content=" GitHub">
<meta property="article:tag" content=" CocoaPods">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://liujiaboy.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false
  };
</script>

  <title>不会飞的小白</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="不会飞的小白" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">不会飞的小白</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Stay Hungry, Stay Foolish</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/liujiaboy" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://liujiaboy.github.io/2020/03/15/Universal-Link/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="不会飞的小白">
      <meta itemprop="description" content="一只iOS程序猿，会陆陆续续的把之前的一些总结搬到这里。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不会飞的小白">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/15/Universal-Link/" class="post-title-link" itemprop="url">Universal Link</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-03-15 17:33:57 / 修改时间：17:46:47" itemprop="dateCreated datePublished" datetime="2020-03-15T17:33:57+08:00">2020-03-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="什么是Universal-Links？"><a href="#什么是Universal-Links？" class="headerlink" title="什么是Universal Links？"></a>什么是Universal Links？</h2><p>iOS9之后，Apple推出的一种通用链接，能够方便的通过https链接来启动APP，通过唯一的网址，不需要特别的schema就可以链接一个特定的视图到APP。<br>这也就设计到universal links的几个特性：</p>
<ol>
<li>Unique：唯一性，不像自定义Url schemes那样，因为他使用到了你网站的http或者https链接</li>
<li>Secure：安全性，当用户安装应用时，iOS会检测你上传到服务器上的文件，以确保你的网站允许其代表应用打开你的应用。</li>
<li>Flexible：灵活性，当没有安装你的app时universal links也是可以正常使用的，当点击link时会直接在safari中打开url。</li>
<li>Simple：一个url可以为app和web提供服务。</li>
<li>Private：其他app可以与你的app通信，不需要知道你的应用程序是否安装。</li>
</ol>
<h2 id="配置Universal-links"><a href="#配置Universal-links" class="headerlink" title="配置Universal links"></a>配置Universal links</h2><p>配置Universal links需要网站与app协同处理，两端都需要做一些工作。</p>
<h3 id="创建并上传关联文件"><a href="#创建并上传关联文件" class="headerlink" title="创建并上传关联文件"></a>创建并上传关联文件</h3><p>首先，你的网站必须支持https。<br><br>然后，创建apple-app-site-association文件，注意一定是没有.json后缀的，在未压缩的情况下，文件大小不能超过128KB。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;applinks&quot;: &#123;</span><br><span class="line">        &quot;apps&quot;: [],</span><br><span class="line">        &quot;details&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;appID&quot;: &quot;9JA89QQLNQ.com.apple.wwdc&quot;,</span><br><span class="line">                &quot;paths&quot;: [ &quot;&#x2F;wwdc&#x2F;news&#x2F;&quot;, &quot;&#x2F;videos&#x2F;wwdc&#x2F;2015&#x2F;*&quot;]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;appID&quot;: &quot;ABCD1234.com.apple.wwdc&quot;,</span><br><span class="line">                &quot;paths&quot;: [ &quot;*&quot; ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><b>appID：</b>是由TeamID+BundleId组成，TeamID可以通过开发者账号来查看，Bundle ID可以直接在工程里查看。<br></p>
<p><b>paths：</b>是一个数组类型用来指定网站路径，并且是大小写敏感的：<br>使用* 指定整个网站，在域名下的任何地址都可以打开App。<br><br>“/wwdc/news/”指定链接，以指定网站的某些部分.<br><br>还可以使用“?”匹配任何单个字符，”/foo/*/bar/201?/mypage”</p>
<p>创建好apple-app-site-association文件后，将其上传到web服务器的跟目录下或者<code>.well-known</code>子目录下。<b>文件是通过https访问不需要有任何重定向。</b>然后你可以直接在浏览器中输入domain/apple-app-site-association或者domain/.well-known/apple-app-site-association访问你所上传的文件。</p>
<p>通过Apple的测试网站可以检测你上传的文件是否正确。<a href="https://search.developer.apple.com/appsearch-validation-tool/" target="_blank" rel="noopener">传送门</a></p>
<p><b>注意：</b></p>
<blockquote>
<p>在用Nginx处理文件的MIME Type配置时，在域名下针对该文件进行处理，也就是说response的Content-Type必须设置为”application/json“。<br>使用Nginx处理文件的MIME Type配置，在server的某个域名下针对该文件处理</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location &#x2F;apple-app-site-association &#123;</span><br><span class="line">    default_type application&#x2F;json;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="项目配置"><a href="#项目配置" class="headerlink" title="项目配置"></a>项目配置</h3><ol>
<li><p>需要支持Universal links的话，需要将开发者中心的配置APPlication Services列表中的ASSociated Domains变成Enabled。</p>
</li>
<li><p>在项目targets-&gt;Capabilities-&gt;Associated Domains中配置App link。在这里需要注意一下，有的域名为<a href="http://www.abc.com和abc.com，这两个对于Universal" target="_blank" rel="noopener">www.abc.com和abc.com，这两个对于Universal</a> links来说是不同的域名，所以，如果你的网站是这两个都需要做处理的话，需要将这两个域名都放在associate domains列表下。在添加时都要将<code>applinks:</code>放在域名前面。<br> 例如：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">applinks:www.abc.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>不需要手动的添加<code>entitlements</code>，当添加domain之后，系统会自动添加相应的文件到工程，如果没有的情况下，只能通过手动添加。 </p>
</li>
<li><p>在AppDelegate中调用方法来处理Universal links的回调。</p>
</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application continueUserActivity:(<span class="built_in">NSUserActivity</span> *)userActivity restorationHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSArray</span> * _Nullable))restorationHandler</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> ([userActivity.activityType isEqualToString:<span class="built_in">NSUserActivityTypeBrowsingWeb</span>]) &#123;</span><br><span class="line">        <span class="built_in">NSURL</span> *webUrl = userActivity.webpageURL;</span><br><span class="line">        <span class="keyword">if</span> ([webUrl.host isEqualToString:<span class="string">@"domain"</span>]) &#123;</span><br><span class="line">            <span class="comment">//打开对应页面</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//不能打开，使用Safari 打开</span></span><br><span class="line">            [[<span class="built_in">UIApplication</span> sharedApplication]openURL:webUrl];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里回传过来一个<code>NSUserActivity</code>类型的数据，对该数据处理来跳转相应的界面。也就不再多说了。<br>到此整体的流程就已经处理完了。相关的内容介绍还是推荐看<a href="https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html#//apple_ref/doc/uid/TP40016308-CH12-SW2" target="_blank" rel="noopener">官方文档</a>，写的比较细致。</p>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol>
<li>apple-app-site-association文件上传一定不要有<code>.json</code>后缀，那些隐藏后缀名的需要注意。</li>
<li>web server必须支持https</li>
<li>上传文件最好在根目录下，官方说也可以在根目录下的<code>.well-known</code>目录下。</li>
<li>Xcode中配置Associated Domians时，一定要添加<code>applinks:</code>前缀。最多添加20-30条。</li>
<li>app在<b>安装</b>的时候会访问<code>domain</code>获取<code>apple-app-site-association</code>文件,这个可以通过抓包来获取。不是在打开app时访问。</li>
<li>直接dev打包到手机上应该就可以测试，保证网络畅通。</li>
<li>最简单的方式检测Universal links是否有效，将那个链接拷贝的备忘录中（imessage、邮件），直接点击链接会跳转到App，或者长按，会在弹出的ActionSheet中第二个显示<code>在xxx中打开</code>。</li>
<li>一定是从上级页面（网页）<b>点击触发</b> 的Universal links。</li>
<li>用 Safari 打开目标域名，或者在其他 App 里用 SFSafariViewController, WKWebView, UIWebView 打开目标域名，都可以达到效果。</li>
</ol>
<h2 id="那些坑"><a href="#那些坑" class="headerlink" title="那些坑"></a>那些坑</h2><h3 id="1-跨域跳转：饿了么遇到的一个问题"><a href="#1-跨域跳转：饿了么遇到的一个问题" class="headerlink" title="1. 跨域跳转：饿了么遇到的一个问题"></a>1. 跨域跳转：<a href="http://mobilists.eleme.io/2016/01/10/%E7%AA%81%E7%A0%B4%E5%BE%AE%E4%BF%A1%E8%B7%B3%E8%BD%AC%E9%99%90%E5%88%B6%EF%BC%8DUniversal-Links%E9%82%A3%E4%BA%9B%E5%9D%91/" target="_blank" rel="noopener">饿了么遇到的一个问题</a></h3><p>这里的问题，就是我们将链接复制在备忘录里发现可以拉起App，但是放在网页里，点击却是没有任何效果，这个几乎就是跨域的锅。</p>
<p>这个应该是在iOS9.2之后出现的问题。假设当前网页是abc.com/a，在这里有一个链接跳转到abc.com/b,还是在同一个域名abc.com下。这时点击，系统将不会进行拉起App的操作，必须在不同的域名下比如abcd.com/b，这样才会根据关联文件去判断是否要拉起app。这个时候就需要在Xcode中添加一个域名在碰到跨域问题不能拉起App时，链接改为其他的域名。<br><a href="https://stackoverflow.com/questions/32751225/ios9-universal-links-does-not-work/32751734#32751734" target="_blank" rel="noopener">这里也有解释</a></p>
<h3 id="2-选择性跳转"><a href="#2-选择性跳转" class="headerlink" title="2. 选择性跳转"></a>2. 选择性跳转</h3><p>这个也是一个坑，苹果会通过Universal links记录用户的行为习惯，当你通过一个Universal links成功的拉起了App，这时你发现在status bar右上角有一个小按钮（带一个小箭头）。当你点击了之后会成功的在Safari中打开，这时，苹果就认为你不需要这个Universal links拉起App，此后在通过这个Universal links点击时，都是在safari或者网页中打开，不会再拉起App。这个是有办法补救的，通过在Safari中点击链接长按，在app中打开。此后通过Universal links就可以拉起App了。也就说，苹果会记录最后一次Universal links的跳转情况来判断是否需要拉起app。</p>
<p>这里感觉第一个的跨域跳转与第二个的选择性跳转是很类似的，第一个在当前域名下点击Universal links不能拉起app就相当于当前系统认为你这个universal links本身就在浏览器中打开的，认为不需要拉起app。</p>
<blockquote>
<p>When a user taps a universal link that you handle, iOS also examines the user’s recent choices to determine whether to open your app or your website. For example, a user who has tapped a universal link to open your app can later choose to open your website in Safari by tapping a breadcrumb button in the status bar. After the user makes this choice, iOS continues to open your website in Safari until the user chooses to open your app by tapping OPEN in the Smart App Banner on the webpage.</p>
</blockquote>
<h3 id="相关网站"><a href="#相关网站" class="headerlink" title="相关网站"></a>相关网站</h3><p><a href="https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html#//apple_ref/doc/uid/TP40016308-CH12-SW2" target="_blank" rel="noopener">官方文档</a></p>
<p>通过Apple的测试网站可以检测你上传的文件是否正确。<a href="https://search.developer.apple.com/appsearch-validation-tool/" target="_blank" rel="noopener">传送门</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://liujiaboy.github.io/2020/03/15/Create-private-pods/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="不会飞的小白">
      <meta itemprop="description" content="一只iOS程序猿，会陆陆续续的把之前的一些总结搬到这里。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不会飞的小白">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/15/Create-private-pods/" class="post-title-link" itemprop="url">创建pod私有库</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-03-15 17:00:47 / 修改时间：17:11:32" itemprop="dateCreated datePublished" datetime="2020-03-15T17:00:47+08:00">2020-03-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9D%82%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">杂记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>看本地cocoaPod库 <code>cd ~/.cocoapods/repos</code>在repos文件夹下面，可以看到你当前存在的一些库，当你创建了自己的私有仓库时，也会在这里显示。</p>
<p>按照正常逻辑来看，私有库是一个地址，版本号管理库是一个地址，最好不要把两者放在一起，会显得很乱。<br>所以创建私有库，我们需要创建两个库：一个是私有仓库repo，用来做私有库的版本管理；另一个是私有代码库，用来做代码编写。</p>
<h2 id="创建私有仓库-repo"><a href="#创建私有仓库-repo" class="headerlink" title="创建私有仓库 repo"></a>创建私有仓库 repo</h2><p>这里的私有空间是指私有库存放的位置，repo是repository（存储库）的缩写，如果私有库的podSpec和代码存放在一起就会显得很乱，所有通常的做法就是再私有空间只存放私有库的podSpec文件（可以理解为版本号）。</p>
<h3 id="创建远程私有repo"><a href="#创建远程私有repo" class="headerlink" title="创建远程私有repo"></a>创建远程私有repo</h3><p>这里使用码云，可以免费创建多个私有工程。例如创建了一个私有存储库：<a href="https://gitee.com/devAlan/PrivateRepo。（已不存在）" target="_blank" rel="noopener">https://gitee.com/devAlan/PrivateRepo。（已不存在）</a></p>
<h3 id="添加到本地仓库中"><a href="#添加到本地仓库中" class="headerlink" title="添加到本地仓库中"></a>添加到本地仓库中</h3><p><code>pod repo add [本地仓库repo名称] [远程repo地址]</code><br><code>pod repo add PrivateRepo https://gitee.com/devAlan/PrivateRepo</code><br>使用上面步骤就可以将远程的私有版本存储仓库添加到本地。在Finder中查看repos中就可以发现增加了一个文件夹PrivateRepo。</p>
<h2 id="创建私有代码库"><a href="#创建私有代码库" class="headerlink" title="创建私有代码库"></a>创建私有代码库</h2><p>创建代码私有库有两种方式，第一种是我们正常的使用Xcode创建项目的过程，另一种是使用pod模板来创建的过程，推荐使用模板来创建。</p>
<h3 id="创建一个私人代码库"><a href="#创建一个私人代码库" class="headerlink" title="创建一个私人代码库"></a>创建一个私人代码库</h3><p>创建一个私人代码库，在创建时添加MIT License和README。<br>使用模板创建时，创建空仓库。</p>
<h4 id="将仓库clone到本地，添加项目工程文件。"><a href="#将仓库clone到本地，添加项目工程文件。" class="headerlink" title="将仓库clone到本地，添加项目工程文件。"></a>将仓库clone到本地，添加项目工程文件。</h4><h4 id="添加-podspec文件"><a href="#添加-podspec文件" class="headerlink" title="添加.podspec文件"></a>添加.podspec文件</h4><p>“.podspec”文件是这个代码库的pod描述文件，使用pod命令创建空白模板。<br><br><code>pod spec create 项目名称</code><br><br>这里使用上面的私有代码库创建<code>pod spec create privateAdd</code>。</p>
<p>需要注意一下：生成的默认的podspec文件中，所有没有注释掉的都必须填写正确。</p>
<h3 id="使用pod模板创建"><a href="#使用pod模板创建" class="headerlink" title="使用pod模板创建"></a>使用pod模板创建</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">pod lib creare [项目名称]（最好与远端一致）</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 以下为模板创建时，会用到的一些选项问题，根据实际选择就好。</span><br><span class="line">What platform do you want to use?? [ iOS &#x2F; macOS ]</span><br><span class="line"> &gt; iOS</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 选择编程语言</span><br><span class="line">What language do you want to use?? [ Swift &#x2F; ObjC ]</span><br><span class="line"> &gt; ObjC</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;&#x2F; 是否需要添加本地库</span><br><span class="line">Would you like to include a demo application with your library? [ Yes &#x2F; No ]</span><br><span class="line"> &gt; No</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 是否有frameworks</span><br><span class="line">Which testing frameworks will you use? [ Specta &#x2F; Kiwi &#x2F; None ]</span><br><span class="line"> &gt; None</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">Would you like to do view based testing? [ Yes &#x2F; No ]</span><br><span class="line"> &gt; No</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 创建的文件前缀</span><br><span class="line">What is your class prefix?</span><br><span class="line"> &gt; HM</span><br></pre></td></tr></table></figure>
<p>上述命令操作完成之后，会生成相应的模板文件。<br>代码文件都存放在<code>/[项目名称]/class/</code>下。<br>图片都存放在<code>/[项目名称]/Assets/</code>下。</p>
<h3 id="将本地-Lib-工程与远程私有-lib-Git-仓库关联"><a href="#将本地-Lib-工程与远程私有-lib-Git-仓库关联" class="headerlink" title="将本地 Lib 工程与远程私有 lib Git 仓库关联"></a>将本地 Lib 工程与远程私有 lib Git 仓库关联</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin 远程仓库地址  </span><br><span class="line">    git错误处理</span><br><span class="line">    git pull --rebase origin master </span><br><span class="line">    git push -u origin master           </span><br><span class="line">    </span><br><span class="line">git push origin master   #同步操作</span><br><span class="line">    文件冲突 （保留一份 license 和 readme）</span><br><span class="line">    git pull origin master --allow-unrelated-histories</span><br><span class="line">    git mergetool</span><br></pre></td></tr></table></figure>

<h2 id="编辑“-podspec”文件"><a href="#编辑“-podspec”文件" class="headerlink" title="编辑“.podspec”文件"></a>编辑“.podspec”文件</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  Be sure to run `pod spec lint PrivateAdd_v2.podspec' to ensure this is a</span></span><br><span class="line"><span class="comment">#  valid spec and to remove all comments including this before submitting the spec.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  To learn more about Podspec attributes see http://docs.cocoapods.org/specification.html</span></span><br><span class="line"><span class="comment">#  To see working Podspecs in the CocoaPods repo see https://github.com/CocoaPods/Specs/</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 声明</span></span><br><span class="line">Pod::Spec.new do |s|</span><br><span class="line"></span><br><span class="line">  <span class="comment"># ―――  Spec Metadata  ―――――――――――――――――――――――――――――――――――――――――――――――――――――――――― #</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  These will help people to find your library, and whilst it</span></span><br><span class="line">  <span class="comment">#  can feel like a chore to fill in it's definitely to your advantage. The</span></span><br><span class="line">  <span class="comment">#  summary should be tweet-length, and the description more in depth.</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># 私有库名称</span></span><br><span class="line">  s.name         = <span class="string">"PrivateAdd_v2"</span>    </span><br><span class="line">  <span class="comment"># 版本号，跟当前版本tag有关</span></span><br><span class="line">  s.version      = <span class="string">"0.0.1"</span>            </span><br><span class="line">  <span class="comment"># 项目描述</span></span><br><span class="line">  s.summary      = <span class="string">"A short description of PrivateAdd_v2."</span> </span><br><span class="line"></span><br><span class="line">  <span class="comment"># This description is used to generate tags and improve search results.</span></span><br><span class="line">  <span class="comment">#   * Think: What does it do? Why did you write it? What is the focus?</span></span><br><span class="line">  <span class="comment">#   * Try to keep it short, snappy and to the point.</span></span><br><span class="line">  <span class="comment">#   * Write the description between the DESC delimiters below.</span></span><br><span class="line">  <span class="comment">#   * Finally, don't worry about the indent, CocoaPods strips it!</span></span><br><span class="line">  s.description  = &lt;&lt;-DESC</span><br><span class="line">                   DESC</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 主页，自动生成的podspec文件中所有的EXAMPLE都需要改</span></span><br><span class="line">  s.homepage     = <span class="string">"http://EXAMPLE/PrivateAdd_v2"</span> </span><br><span class="line">  <span class="comment"># 项目截图</span></span><br><span class="line">  <span class="comment"># s.screenshots  = "www.example.com/screenshots_1.gif", "www.example.com/screenshots_2.gif"  </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment"># ―――  Spec License  ――――――――――――――――――――――――――――――――――――――――――――――――――――――――――― #</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  Licensing your code is important. See http://choosealicense.com for more info.</span></span><br><span class="line">  <span class="comment">#  CocoaPods will detect a license file if there is a named LICENSE*</span></span><br><span class="line">  <span class="comment">#  Popular ones are 'MIT', 'BSD' and 'Apache License, Version 2.0'.</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 项目遵守的协议</span></span><br><span class="line">  s.license      = <span class="string">"MIT (example)"</span>      </span><br><span class="line">  <span class="comment"># s.license      = &#123; :type =&gt; "MIT", :file =&gt; "FILE_LICENSE" &#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment"># ――― Author Metadata  ――――――――――――――――――――――――――――――――――――――――――――――――――――――――― #</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  Specify the authors of the library, with email addresses. Email addresses</span></span><br><span class="line">  <span class="comment">#  of the authors are extracted from the SCM log. E.g. $ git log. CocoaPods also</span></span><br><span class="line">  <span class="comment">#  accepts just a name if you'd rather not provide an email address.</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  Specify a social_media_url where others can refer to, for example a twitter</span></span><br><span class="line">  <span class="comment">#  profile URL.</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 作者信息</span></span><br><span class="line">  s.author             = &#123; "liujiajia" =&gt; "liujiajia@gerrit.babytree-inc.com" &#125;  </span><br><span class="line">  <span class="comment"># Or just: s.author    = "liujiajia"</span></span><br><span class="line">  <span class="comment"># s.authors            = &#123; "liujiajia" =&gt; "liujiajia@gerrit.babytree-inc.com" &#125;</span></span><br><span class="line">  <span class="comment"># s.social_media_url   = "http://twitter.com/liujiajia"</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># ――― Platform Specifics ――――――――――――――――――――――――――――――――――――――――――――――――――――――― #</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  If this Pod runs only on iOS or OS X, then specify the platform and</span></span><br><span class="line">  <span class="comment">#  the deployment target. You can optionally include the target after the platform.</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># s.platform     = :ios           # 平台</span></span><br><span class="line">  <span class="comment"># 平台以及版本号</span></span><br><span class="line">  <span class="comment"># s.platform     = :ios, "5.0"    </span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#  When using multiple platforms</span></span><br><span class="line">  <span class="comment"># s.ios.deployment_target = "5.0"</span></span><br><span class="line">  <span class="comment"># s.osx.deployment_target = "10.7"</span></span><br><span class="line">  <span class="comment"># s.watchos.deployment_target = "2.0"</span></span><br><span class="line">  <span class="comment"># s.tvos.deployment_target = "9.0"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment"># ――― Source Location ―――――――――――――――――――――――――――――――――――――――――――――――――――――――――― #</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  Specify the location from where the source should be retrieved.</span></span><br><span class="line">  <span class="comment">#  Supports git, hg, bzr, svn and HTTP.</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#当前私有库资源的git地址，相应的tag，这里直接使用代码来标识使用和当前tag一样的值</span></span><br><span class="line">  s.source       = &#123; :git =&gt; "http://EXAMPLE/PrivateAdd_v2.git", :tag =&gt; "#&#123;s.version&#125;" &#125;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment"># ――― Source Code ―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――― #</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  CocoaPods is smart about how it includes source code. For source files</span></span><br><span class="line">  <span class="comment">#  giving a folder will include any swift, h, m, mm, c &amp; cpp files.</span></span><br><span class="line">  <span class="comment">#  For header files it will include any header in the folder.</span></span><br><span class="line">  <span class="comment">#  Not including the public_header_files will make all headers public.</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 需要引用的文件代码，classes文件夹下的所有.h.m文件。这里的路径都是相对路径</span></span><br><span class="line">  s.source_files  = <span class="string">"Classes"</span>, <span class="string">"Classes/**/*.&#123;h,m&#125;"</span> </span><br><span class="line">  <span class="comment"># 排除掉哪些文件，不被包含的文件，这里是Classes/Exclude文件夹下的所有</span></span><br><span class="line">  s.exclude_files = <span class="string">"Classes/Exclude"</span>   </span><br><span class="line"></span><br><span class="line">  <span class="comment"># s.public_header_files = "Classes/**/*.h"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment"># ――― Resources ―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――― #</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  A list of resources included with the Pod. These are copied into the</span></span><br><span class="line">  <span class="comment">#  target bundle with a build phase script. Anything else will be cleaned.</span></span><br><span class="line">  <span class="comment">#  You can preserve files from being cleaned, please don't preserve</span></span><br><span class="line">  <span class="comment">#  non-essential files like tests, examples and documentation.</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># s.resource  = "icon.png"            # 资源文件</span></span><br><span class="line">  <span class="comment"># s.resources = "Resources/*.png"     # 所有资源文件</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># s.preserve_paths = "FilesToSave", "MoreFilesToSave"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment"># ――― Project Linking ―――――――――――――――――――――――――――――――――――――――――――――――――――――――――― #</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  Link your library with frameworks, or libraries. Libraries do not include</span></span><br><span class="line">  <span class="comment">#  the lib prefix of their name.</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># s.framework  = "UIKit"          # 依赖的系统framework，去掉后缀</span></span><br><span class="line">  <span class="comment"># s.frameworks = "SomeFramework", "AnotherFramework"</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># s.library   = "iconv"                   # 依赖的系统library</span></span><br><span class="line">  <span class="comment"># s.libraries = "iconv", "xml2", "z"      # 依赖的library，去除前缀和后缀，例如“libz.tbd”，则直接引用为"z"</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># s.vendored_frameworks = "*.framework", "*.framework"          #依赖那些静态库</span></span><br><span class="line">  <span class="comment"># s.vendored_libraries = "*.a", "*.a"           # 依赖哪些静态library</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment"># ――― Project Settings ――――――――――――――――――――――――――――――――――――――――――――――――――――――――― #</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  If your library depends on compiler flags you can set them in the xcconfig hash</span></span><br><span class="line">  <span class="comment">#  where they will only apply to your library. If you depend on other Podspecs</span></span><br><span class="line">  <span class="comment">#  you can include multiple dependencies to ensure it works.</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># s.requires_arc = true       # 是否开启ARC</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># s.xcconfig = &#123; "GCC_PREPROCESSOR_DEFINITIONS" =&gt; 'HMTIMEINPREGNACYAPP=1', "HEADER_SEARCH_PATHS" =&gt; "$(SDKROOT)/usr/include/libxml2" &#125;  </span></span><br><span class="line">  <span class="comment"># 这里配置一些内容，"GCC_PREPROCESSOR_DEFINITIONS"：定义一个宏，</span></span><br><span class="line">  <span class="comment"># "HEADER_SEARCH_PATHS"：如果引用该私有库，则会在主工程中寻找文件夹下的内容</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># s.dependency "JSONKit", "~&gt; 1.4"        # 使用了pod，依赖哪些库</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># s.prefix_header_contents = &lt;&lt;-EOS     #这里会生成一个默认pch文件，作用于Xcode工程中添加的pch文件一样。</span></span><br><span class="line">  <span class="comment">#      #import &lt;UIKit/UIKit.h&gt;</span></span><br><span class="line">  <span class="comment"># EOS</span></span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>这里有一个需要注意的地方，在创建私有库的时候，找不到MIT LICENSE证书，这里讲license修改一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.license      &#x3D; &#123; :type &#x3D;&gt; &quot;MIT&quot;, :file &#x3D;&gt; &quot;LICENSE&quot; &#125;</span><br></pre></td></tr></table></figure>

<h2 id="二级库subspec"><a href="#二级库subspec" class="headerlink" title="二级库subspec"></a>二级库subspec</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s.subspec &#39;UIView+Category&#39; do |ss| </span><br><span class="line">  ss.source_files &#x3D; &quot;PrivateAdd_v3&#x2F;PrivateAdd_v3&#x2F;Classes&#x2F;UIView+Category&#x2F;*.&#123;h,m&#125;&quot;</span><br><span class="line">  ss.framework &#x3D; &quot;UIKit&quot;</span><br><span class="line">  # ss.vendored_libraries &#x3D; &#39;&#x2F;*.a&#39;</span><br><span class="line">  # ss.vendored_frameworks &#x3D; &#39;&#x2F;*.framework&#39;</span><br><span class="line">  # ss.resource &#x3D; &#39;Moments&#x2F;ForPregnacy&#x2F;**&#x2F;*.bundle&#39;, &#39;Moments&#x2F;ForPregnacy&#x2F;**&#x2F;*.png&#39;, &#39;Moments&#x2F;ForPregnacy&#x2F;**&#x2F;*.mp3&#39;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>使用subspec关键字，并添加指定文件就行。</p>
<h2 id="验证私有库"><a href="#验证私有库" class="headerlink" title="验证私有库"></a>验证私有库</h2><p>修改完相应的代码块之后，开始验证私有库配置是否正确。</p>
<h3 id="本地验证"><a href="#本地验证" class="headerlink" title="本地验证"></a>本地验证</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pod lib lint</span><br><span class="line">&#x2F;&#x2F; 如果使用了私有库，则使用--sources来标明，给出具体地址</span><br><span class="line">pod lib lint --sources&#x3D;[私有仓库repo地址],[私有库git地址],https:&#x2F;&#x2F;github.com&#x2F;CocoaPods&#x2F;Specs.git</span><br></pre></td></tr></table></figure>

<p>如果出现错误，基本上都是podspec文件中的配置出现了问题，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ pod lib lint</span><br><span class="line"></span><br><span class="line"> -&gt; PrivateAdd_v2 (0.0.1)</span><br><span class="line">    - WARN  | attributes: Missing required attribute &#96;license&#96;.</span><br><span class="line">    - WARN  | license: Missing license type.</span><br><span class="line">    - ERROR | description: The description is empty.</span><br><span class="line">    - ERROR | [iOS] unknown: Encountered an unknown error (The &#96;PrivateAdd_v2&#96; pod failed to validate due to 1 error:</span><br><span class="line">    - WARN  | attributes: Missing required attribute &#96;license&#96;.</span><br><span class="line">    - WARN  | license: Missing license type.</span><br><span class="line">    - ERROR | description: The description is empty.</span><br><span class="line"></span><br><span class="line">) during validation.</span><br><span class="line"></span><br><span class="line">[!] PrivateAdd_v2 did not pass validation, due to 2 errors and 2 warnings.</span><br><span class="line">You can use the &#96;--no-clean&#96; option to inspect any issue.</span><br></pre></td></tr></table></figure>
<p>这就需要将上面的错误修改掉。</p>
<p>一般情况下出现警告在后面添加<code>pod lib lint --allow-warnings</code>，就可以通过验证了。验证通过会提示passed validation。</p>
<p>如果依赖一些静态库（.framework，.a），则在命令后面添加<code>--use-libraries</code>，表示依赖了静态库。</p>
<p>如果报错不是很明显，这命令后添加<code>--verbose</code>，会输出验证的过程，并给出报错信息。</p>
<h3 id="远端验证"><a href="#远端验证" class="headerlink" title="远端验证"></a>远端验证</h3><p><code>pod spec lint</code>，一般情况下私有库都是存在远程git上的，所以基本上只在第一次验证使用本地验证之后，就可以直接使用远端验证了。<br>但是一般情况下，创建的私有代码库如果是私有的（并不是官方的），这时候，我们在做远端验证时，需要添加代码地址。，不然pod会默认从官方repo查询。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pod spec lint --sources&#x3D;[私有仓库repo地址],[私有库git地址],https:&#x2F;&#x2F;github.com&#x2F;CocoaPods&#x2F;Specs.git</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 或者只添加前面两项，最后一项可以忽略</span><br><span class="line">pod spec lint --sources&#x3D;[私有仓库repo地址],[私有库git地址]</span><br></pre></td></tr></table></figure>
<p>如果出现一些警告，可以直接在命令最后添加<code>--allow-warnings</code>来屏蔽警告。例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pod spec lint --sources&#x3D;https:&#x2F;&#x2F;gitee.com&#x2F;devAlan&#x2F;PrivateRepo,https:&#x2F;&#x2F;gitee.com&#x2F;devAlan&#x2F;PrivateAdd_v3.git,https:&#x2F;&#x2F;github.com&#x2F;CocoaPods&#x2F;Specs.git --allow-warnings</span><br><span class="line"></span><br><span class="line">pod spec lint --sources&#x3D;https:&#x2F;&#x2F;gitee.com&#x2F;devAlan&#x2F;PrivateRepo,https:&#x2F;&#x2F;gitee.com&#x2F;devAlan&#x2F;PrivateAdd_v3.git --allow-warnings</span><br></pre></td></tr></table></figure>

<h2 id="发布私有库"><a href="#发布私有库" class="headerlink" title="发布私有库"></a>发布私有库</h2><p>将podspec文件推送到私有空间repo，在发布时一定要记住，已经做了tag处理。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pod repo push [私有仓库repo] [私有库podspec文件地址] --allow-warnings</span><br><span class="line">pod repo push [私有仓库repo] [私有库podspec文件地址] --sources&#x3D;[私有仓库repo地址],[私有库地址],https:&#x2F;&#x2F;gitee.com&#x2F;devAlan&#x2F;PrivateAdd_v2.git --allow-warnings</span><br></pre></td></tr></table></figure>
<p>由于基本上的所有命令操作都是在该私有库文件夹下，所以不用管podspec的文件位置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod repo push PrivateRepo PrivateAdd.podspec --allow-warnings</span><br></pre></td></tr></table></figure>

<p>执行该命令时，相当于直接将podspec文件push到repo的Git地址上。</p>
<h2 id="引用私有库"><a href="#引用私有库" class="headerlink" title="引用私有库"></a>引用私有库</h2><h3 id="本地路径引用"><a href="#本地路径引用" class="headerlink" title="本地路径引用"></a>本地路径引用</h3><p>做好验证之后，如果需要测试，可以直接在podfile中引用私有库的本地路径</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; ..&#x2F;是回到上一级文件目录，是以当前podfile所在文件位置决定</span><br><span class="line">pod &#39;Private_v2&#39;, :path &#x3D;&gt; &#39;..&#x2F;..&#x2F;Private_v2&#39;</span><br></pre></td></tr></table></figure>
<p>这个时候如果改动Private_v2中的代码就是直接改动。</p>
<h3 id="repo引用"><a href="#repo引用" class="headerlink" title="repo引用"></a>repo引用</h3><p>在podfile中先添加source，然后直接pod引入，当然在引用私有库的时候，不仅需要需要私有仓库repo的权限，还需要有私有库的权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">source &#39;https:&#x2F;&#x2F;gitee.com&#x2F;devAlan&#x2F;PrivateRepo&#39;</span><br><span class="line"> </span><br><span class="line">pod &#39;Private_v2&#39;</span><br><span class="line"></span><br><span class="line">#或者使用下面的方式</span><br><span class="line">#pod &#39;Private_v2&#39;, :git&#x3D;&gt; &#39;https:&#x2F;&#x2F;gitee.com&#x2F;devAlan&#x2F;PrivateRepo&#39;</span><br></pre></td></tr></table></figure>


<h2 id="pod-常用命令"><a href="#pod-常用命令" class="headerlink" title="pod 常用命令"></a>pod 常用命令</h2><ol>
<li><p>安装podfile中依赖的命令<br><code>pod install</code><br><code>pod update</code><br><code>--no-repo-update</code>   不需要更新repo<br><code>--repo-update</code>   更新repo</p>
</li>
<li><p>repo相关<br><code>pod repo list</code><br><code>pod repo remove xxx</code>   移除一个本地repo<br><code>pod repo add [本地仓库repo名称] [远程repo地址]</code>  远程版本空间添加到本地</p>
</li>
<li><p>私有库创建相关<br><code>pod lib lint</code>      本地验证<br><code>pod spec lint</code>     远程验证<br><code>pod repo push [本地仓库repo] [*.podspec]</code>  发布版本到repo<br><code>--source=[私有repo地址][私有代码库地址][pod地址]</code><br><code>--allow-warnings</code>  忽略warning<br><code>--use-libraries</code>   使用了第三方的framework或者.a文件<br><code>--verbose</code>         打印流程，可以快速定位失败原因</p>
</li>
<li><p>podspec中使用到的*<br><code>/**</code> 子目录下所有文件夹<br><code>/*</code>    目录下所有文件</p>
</li>
</ol>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><ol>
<li><p>私有库依赖主项目中的某些文件，如果是强制性的依赖，导致本地验证和远程验证都无法通过，所以更别说发布了。<br> 这种是没有完全的组件化。我们需要在podspec中添加HEADER_SEARCH_PATHS，添加指定位置文件路径。这里的路径也是相对路径。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s.xcconfig &#x3D; &#123; &quot;GCC_PREPROCESSOR_DEFINITIONS&quot; &#x3D;&gt; &#39;HMTIMEINPREGNACYAPP&#x3D;1&#39;, </span><br><span class="line">&quot;HEADER_SEARCH_PATHS&quot; &#x3D;&gt; &quot;$(SRCROOT)&#x2F;usr&#x2F;include&#x2F;libxml2&quot;, $(SRCROOT)&#x2F;..&#x2F;Commen&#x2F;** &#125;</span><br></pre></td></tr></table></figure>

<p>但是这样做仍然无法通过验证，这就需要我们将私有空间repo pull到本地，手动创建版本号文件夹添加podspec文件，然后push。</p>
</li>
<li><p>在上面的代码中还有一个 <code>GCC_PREPROCESSOR_DEFINITIONS</code>，这是定义一个宏，可以在Project-Build Settings - Preprocessor Macros下看到。</p>
<p>可以配合一些没有必要引入私有代码库中的文件来使用。</p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://liujiaboy.github.io/2020/03/10/Cocoapods-can-not-used/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="不会飞的小白">
      <meta itemprop="description" content="一只iOS程序猿，会陆陆续续的把之前的一些总结搬到这里。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不会飞的小白">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/10/Cocoapods-can-not-used/" class="post-title-link" itemprop="url">Mac升级造成cocoapods不可用</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-10 17:00:52" itemprop="dateCreated datePublished" datetime="2020-03-10T17:00:52+08:00">2020-03-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-15 17:14:02" itemprop="dateModified" datetime="2020-03-15T17:14:02+08:00">2020-03-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9D%82%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">杂记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Mac系统升级之后，造成pods不可用，这里找到了解决的方案，前提是已经安装了cocoapods。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo gem update --system</span><br><span class="line">sudo gem install -n &#x2F;usr&#x2F;local&#x2F;bin cocoapods -v1.5.3</span><br><span class="line">pod setup</span><br></pre></td></tr></table></figure>

<p>第一步：更新gem。<br>第二步：安装指定的cocoapods版本，我这里指定的是1.5.3<br>第三步：更新pod</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://liujiaboy.github.io/2020/03/06/Github-Hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="不会飞的小白">
      <meta itemprop="description" content="一只iOS程序猿，会陆陆续续的把之前的一些总结搬到这里。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不会飞的小白">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/06/Github-Hexo/" class="post-title-link" itemprop="url">利用Github从零开始搭建Hexo博客，可迁移</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-06 22:07:06" itemprop="dateCreated datePublished" datetime="2020-03-06T22:07:06+08:00">2020-03-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-10 17:05:18" itemprop="dateModified" datetime="2020-03-10T17:05:18+08:00">2020-03-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9D%82%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">杂记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><ol>
<li>安装Node.js，安装完成之后可以正常使用npm命令</li>
<li>安装hexo，<code>npm install -g hexo-cli</code></li>
</ol>
<h2 id="创建步奏"><a href="#创建步奏" class="headerlink" title="创建步奏"></a>创建步奏</h2><ol>
<li><p>创建git仓库，这里需要注意一下，GitPage会默认给分配二级域名，但是当仓库名与账号组织名称一样的情况下会省略掉二级域名，所以这里创建的名称为<code>{yourname}.github.io</code>，一定是以<code>github.io</code>结尾的。当然也可以创建其他的。只是在之后的配置上略有不同。</p>
</li>
<li><p>创建仓库时使用readme进行初始化。</p>
</li>
<li><p>同时新建一个hexo分支，并设置为默认分支。</p>
</li>
<li><p>使用<code>hexo init {name}</code>来初始化，或者新建一个<code>{name}</code>文件夹，在该文件夹下，执行<code>hexo init</code>命令是一样的效果。</p>
</li>
<li><p>依次执行</p>
<p> <code>hexo clean</code>：clean<br> <code>hexo g</code>：generate，编译生成HTML代码，放在根目录下的public下。<br> <code>hexo s</code>：serve，提供serve命令把博客在本地运行起来，然后点击给出的链接就可以正常的使用了，如果链接打不开，可能是端口被占用，可以使用<code>hexo s -p 端口号</code>来指定端口号。</p>
</li>
<li><p>我这里是用了一个比较主流的主题<a href="https://github.com/theme-next/hexo-theme-next" target="_blank" rel="noopener">next</a>，以此为例，大家喜欢什么主题自己配置就好。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;theme-next&#x2F;hexo-theme-next themes&#x2F;next</span><br></pre></td></tr></table></figure>

<p> 依次执行命令进行配置就好了。随后在根目录下的<code>_config.yml</code>文件里配置： <code>next</code>。</p>
</li>
</ol>
<ol start="7">
<li><p>删除主题下的git。这里有一点要注意的，在remote远程仓库之前，要把<b>themes文件夹</b>拉下来的主题，删除对应的<b>.git</b>文件删除掉。因为外部已经有了git，内部文件夹也有git时会出现问题。</p>
</li>
<li><p>配置根目录下的<code>_config.yml</code>文件</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Site</span><br><span class="line">title: 不会飞的小白</span><br><span class="line">subtitle: &#39;Stay Hungry, Stay Foolish&#39;</span><br><span class="line">description: &#39;&#39;</span><br><span class="line">keywords: iOS, Swift, GitHub</span><br><span class="line">author: 不会飞的小白</span><br><span class="line">language: zh-CN</span><br><span class="line">timezone: &#39;&#39;</span><br></pre></td></tr></table></figure>
<p> <b>Site里头的东西，根据自身想法看着写就行。有一个需要注意的是language，它的值是根据对应的Theme中的语言相对应的。</b></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># URL</span><br><span class="line">## If your site is put in a subdirectory, set url as &#39;http:&#x2F;&#x2F;yoursite.com&#x2F;child&#39; and root as &#39;&#x2F;child&#x2F;&#39;</span><br><span class="line">url: http:&#x2F;&#x2F;liujiaboy.github.io&#x2F;</span><br><span class="line">root: &#x2F;</span><br></pre></td></tr></table></figure>

<p> <b>这里也需要注意。如果添加了搜索功能或者没有按照{name}.github.io这种命名方式创建的，这里的是必须要填写的。URL：为Github Page生成后对应的地址。root：为哪一级为根目录。</b></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https:&#x2F;&#x2F;hexo.io&#x2F;plugins&#x2F;</span><br><span class="line">## Themes: https:&#x2F;&#x2F;hexo.io&#x2F;themes&#x2F;</span><br><span class="line">theme: next</span><br><span class="line">#主题</span><br><span class="line"></span><br><span class="line"># Deployment</span><br><span class="line">## Docs: https:&#x2F;&#x2F;hexo.io&#x2F;docs&#x2F;deployment.html</span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https:&#x2F;&#x2F;github.com&#x2F;liujiaboy&#x2F;liujiaboy.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>
<p> <b>这里是对应的仓库地址，type一定是 git类型，分支可以选择，我这里是master。</b></p>
</li>
<li><p>上面的配置完成之后，再执行<b>步奏5</b>，本地预览没问题后，可以直接走发布。而发布也就是将生成的public文件中的内容push到deploy对应的仓库的分支中。</p>
<p> <code>hexo d</code>:deploy: 发布。<br> 如果出现问题，执行<code>npm install hexo-deployer-git</code>安装git插件。</p>
</li>
<li><p>这个时候，可以在根目录下，remote远程仓库了。</p>
<p><code>git remote add origin &lt;远程版本库URL&gt;</code>。这个时候本地默认就是之前创建的<code>hexo</code>分支。</p>
<p>执行<code>git add .</code>, <code>git commit -m&quot;xxx&quot;</code>之后，在push之前，先把远程分支上的内容pull下来。这个时候执行</p>
<p><code>git pull origin hexo</code></p>
<p>如果出现问题，是因为本地有提交内容无法完成merge操作。将上面的执行命令改为</p>
<p><code>git pull origin hexo --allow-unrelated-histories</code></p>
<p>完成merge操作之后，执行<code>git push origin hexo</code>就可以了。</p>
</li>
</ol>
<p>这个时候就已经完成了整体的库都放在Github上了。默认分支hexo存放所有的数据，master分支存放Github Page需要的数据。这就可以开心的玩耍了，也不用担心换设备迁移带来的问题了。</p>
<h2 id="hexo迁移"><a href="#hexo迁移" class="headerlink" title="hexo迁移"></a>hexo迁移</h2><ol>
<li><p>确保当前设备已经有Node.js, hexo环境。</p>
</li>
<li><p>从远程仓库clone到指定文件夹。</p>
</li>
<li><p>在该文件夹下，执行</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo --save</span><br></pre></td></tr></table></figure>
<p> 这一步是必须执行的，创建hexo环境，如果在本电脑的环境下已经执行过下面两个命令，就不用重复执行了。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br><span class="line">npm install hexo-deployer-git</span><br></pre></td></tr></table></figure>

<p> 这个时候就没必要执行<code>hexo init</code>了，因为当文件夹下有内容的时候跟本执行不了，会报错。</p>
</li>
<li><p>如果是多设备同时开发的话，那就需要用到 <code>git pull origin hexo</code>来拉取最新数据了，但是一般情况下不会出现，毕竟自己的博客不会涉及到多人协作。</p>
</li>
<li><p>就可以开心的玩耍了。</p>
</li>
</ol>
<h2 id="相关配置"><a href="#相关配置" class="headerlink" title="相关配置"></a>相关配置</h2><h3 id="NexT主题添加theme-next-canvas-nest几何动效"><a href="#NexT主题添加theme-next-canvas-nest几何动效" class="headerlink" title="NexT主题添加theme-next-canvas-nest几何动效"></a>NexT主题添加theme-next-canvas-nest几何动效</h3><figure class="highlight obj-c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd themes/next</span><br><span class="line">git clone https:<span class="comment">//github.com/theme-next/theme-next-canvas-nest source/lib/canvas-nest</span></span><br></pre></td></tr></table></figure>
<p>完成上诉操作之后，再next配置文件_config.yml中配置开启canvas_nest，如果没有相关配置，直接复制代码粘贴进去就行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">canvas_nest:</span><br><span class="line">  enable: true</span><br><span class="line">  onmobile: true # display on mobile or not</span><br><span class="line">  color: &#39;0,0,255&#39; # RGB values, use &#39;,&#39; to separate</span><br><span class="line">  opacity: 0.5 # the opacity of line: 0~1</span><br><span class="line">  zIndex: -1 # z-index property of the background</span><br><span class="line">  count: 99 # the number of lines</span><br></pre></td></tr></table></figure>

<h3 id="订阅-rss"><a href="#订阅-rss" class="headerlink" title="订阅 rss"></a>订阅 rss</h3><p>博客一般都需要rss订阅，如果要开启，需要安装一个插件。安装完成会自动生成相关配置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-feed --save</span><br></pre></td></tr></table></figure>

<p>生成的rss对应的文件public/atom.xml</p>
<h3 id="创建文章"><a href="#创建文章" class="headerlink" title="创建文章"></a>创建文章</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new &lt;文章名&gt;</span><br></pre></td></tr></table></figure>
<p>新建一篇文章，使用markdown的格式。在一篇文章的开头，会有如下必要信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 利用Github从零开始搭建Hexo博客，可迁移</span><br><span class="line">date: 2020-03-06 22:07:06</span><br><span class="line">tags:</span><br><span class="line">    - Github</span><br><span class="line">    - hexo</span><br><span class="line"></span><br><span class="line">categories:</span><br><span class="line">    - 杂记</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>其中title， date是必填的，tags就是标签，可选， categories：分类，也是可选。在next主题下，默认会生成目录。</p>
<h3 id="创建标签页-tags"><a href="#创建标签页-tags" class="headerlink" title="创建标签页 tags"></a>创建标签页 tags</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure>

<p>也会生成类似文章的md文件，可以在头部自行添加。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">title: tags</span><br><span class="line">date: 2020-03-06 22:07:06</span><br><span class="line">type: tags</span><br><span class="line">comments: false</span><br></pre></td></tr></table></figure>
<p>type: 指定为tags<br>comments：是否允许评论</p>
<h3 id="分类页-categories"><a href="#分类页-categories" class="headerlink" title="分类页 categories"></a>分类页 categories</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure>
<p>指定type：categories</p>
<p>hexo默认会创建<code>archives</code>类型的文件，不会默认创建tags和categories，但是创建完成这两个之后，只需要指定type类型即可，不用在文件中添加其他数据。</p>
<h3 id="搜索页"><a href="#搜索页" class="headerlink" title="搜索页"></a>搜索页</h3><p>很多情况下需要搜索全站内容，所以有必要支持搜索。需要安装插件支持</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>

<p>很多主题对应的搜索都不一样，但是搜索的插件都是必须的。这里需要修改上面提到的URL并指定root文件路径。</p>
<h3 id="404页面"><a href="#404页面" class="headerlink" title="404页面"></a>404页面</h3><p>当页面出错的时候，就很有必要的添加一个404的错误页面。直接在根目录下创建一个404.md文件即可。也有会接入腾讯公益404广告的，自行google吧。</p>
<p>这个只针对绑定域名的有效，GitHub默认分配的是没有效果的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 404 Not Found</span><br><span class="line">date: 2020-03-06 11:06:55</span><br><span class="line">---</span><br><span class="line">&lt;center&gt;</span><br><span class="line">    对不起，您访问的页面不存在或已被删除</span><br><span class="line">&lt;&#x2F;center&gt;</span><br></pre></td></tr></table></figure>

<h3 id="创建about"><a href="#创建about" class="headerlink" title="创建about"></a>创建about</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page about</span><br></pre></td></tr></table></figure>




<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>感谢大佬们做的总结，不一一列举了。感谢<br><a href="https://github.com/theme-next/hexo-theme-next" target="_blank" rel="noopener">next: Github</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="不会飞的小白"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">不会飞的小白</p>
  <div class="site-description" itemprop="description">一只iOS程序猿，会陆陆续续的把之前的一些总结搬到这里。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/liujiaboy" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;liujiaboy" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:alan129@163.com" title="E-Mail → mailto:alan129@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/1768698000" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;1768698000" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-fw fa-rss"></i></a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">不会飞的小白</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.7.2
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
